<!DOCTYPE html>
<html ‚ö°>
<head>
    <meta charset="utf-8">

    <title>Router Pattern &lt;/&gt; TL;DR: JavaScript Codecasts</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <meta name="description" content="üé¨ How do you tame if-else or switch statements that grow with every feature request? üò¨ Let the Router design pattern turn your code inside out!" />
    <link rel="shortcut icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://jonathanleemartin.com/tldr/02-router-pattern/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="tl;dr" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Router Pattern &lt;/&gt; TL;DR: JavaScript Codecasts" />
    <meta property="og:description" content="üé¨ How do you tame if-else or switch statements that grow with every feature request? üò¨ Let the Router design pattern turn your code inside out!" />
    <meta property="og:url" content="https://jonathanleemartin.com/tldr/02-router-pattern/" />
    <meta property="og:image" content="https://jonathanleemartin.com/content/images/2019/09/02-router-pattern-1.png" />
    <meta property="article:published_time" content="2019-09-18T16:00:00.000Z" />
    <meta property="article:modified_time" content="2019-10-16T18:19:08.000Z" />
    <meta property="article:tag" content="tl;dr" />
    <meta property="article:tag" content="JavaScript" />
    <meta property="article:tag" content="Design Pattern" />
    <meta property="article:tag" content="Web" />
    <meta property="article:tag" content="React" />
    <meta property="article:tag" content="Node" />
    
    <meta property="article:publisher" content="https://www.facebook.com/yellowscale" />
    <meta property="article:author" content="https://www.facebook.com/yellowscale" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Router Pattern &lt;/&gt; TL;DR: JavaScript Codecasts" />
    <meta name="twitter:description" content="üé¨ How do you tame if-else or switch statements that grow with every feature request? üò¨ Let the Router design pattern turn your code inside out!" />
    <meta name="twitter:url" content="https://jonathanleemartin.com/tldr/02-router-pattern/" />
    <meta name="twitter:image" content="https://jonathanleemartin.com/content/images/2019/09/02-router-pattern-1.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Jonathan Lee Martin" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="tl;dr, JavaScript, Design Pattern, Web, React, Node" />
    <meta name="twitter:site" content="@nybblr" />
    <meta name="twitter:creator" content="@nybblr" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "tl;dr",
        "logo": {
            "@type": "ImageObject",
            "url": "https://jonathanleemartin.com/content/images/2019/08/logo.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Jonathan Lee Martin",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/6dc50195bf39376a9154e48d6b5df778?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://jonathanleemartin.com/author/jonathan/",
        "sameAs": [
            "https://jonathanleemartin.com/",
            "https://www.facebook.com/yellowscale",
            "https://twitter.com/nybblr"
        ]
    },
    "headline": "Router Pattern &lt;/&gt; TL;DR: JavaScript Codecasts",
    "url": "https://jonathanleemartin.com/tldr/02-router-pattern/",
    "datePublished": "2019-09-18T16:00:00.000Z",
    "dateModified": "2019-10-16T18:19:08.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://jonathanleemartin.com/content/images/2019/09/02-router-pattern-1.png",
        "width": 1920,
        "height": 1080
    },
    "keywords": "tl;dr, JavaScript, Design Pattern, Web, React, Node",
    "description": "üé¨ How do you tame if-else or switch statements that grow with every feature request? üò¨ Let the Router design pattern turn your code inside out!",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://jonathanleemartin.com/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.27" />
    <link rel="alternate" type="application/rss+xml" title="tl;dr" href="https://jonathanleemartin.com/rss/" />

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,600,400" />
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="https://jonathanleemartin.com">tl;dr</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">02. Router Pattern</h1>
                <section class="post-meta">
                    <p class="author">by <a href="/author/jonathan/">Jonathan Lee Martin</a></p>
                    <time class="post-date" datetime="2019-09-18">2019-09-18</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="https://jonathanleemartin.com/content/images/2019/09/02-router-pattern-1.png" width="600" height="400" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>How do you tame a group of if-else or switch statements that grows with every feature request? Let‚Äôs continue obliterating if-else statements on today‚Äôs episode of <a href="https://www.youtube.com/channel/UCol-gOYBawJGqUn2AhwxhNg">TL;DR</a>, the JavaScript codecast series that teaches working web developers to craft exceptional software in 5 minutes a week.</p>

<h3 id="transcript">Transcript</h3>
<p>Last episode we covered nested ternaries. Nested ternaries are a great replacement for if-else statements when we need the power of a conditional, but can afford to replace statements with expressions. But sometimes the number of cases just gets longer and longer.</p>
<p>Even if you extracted each case to a separate function, the function wrapping around the if-else or switch statement will continue to grow unbounded.</p>
<p>Especially in codebases that change hands often, this promotes a sloppy, inconsistent boundary between the individual cases and the mapping logic that decides which case to run.</p>
<p>Today we‚Äôre refactoring some code for a chatbot that helps outdoor enthusiasts find great trails to hike.</p>
<pre><code class="language-javascript">console.log( responder('list hikes') );
// =&gt; Lost Lake
// =&gt; Canyon Creek Meadows
console.log( responder('recommend hike') );
// =&gt; I recommend Mirror Lake.
console.log( responder('add hike Mirror Lake') );
// =&gt; Added Mirror Lake!
console.log( responder('where is Mirror Lake') );
// =&gt; Sorry, I don‚Äôt understand that.
</code></pre>
<p>So far this chatbot can respond to a few basic commands, like ‚Äúlist hikes‚Äù, ‚Äúrecommend hike‚Äù, and ‚Äúadd hike‚Äù. If you ask the chatbot something it doesn‚Äôt understand ‚Äî like ‚Äúwhere is Mirror Lake‚Äù ‚Äî it responds with a fallback message.</p>
<p>At the moment, all of this logic lives in the responder function. Our chatbot currently has 4 behaviors, so there are 3 if-else cases and one fallback return statement.</p>
<pre><code class="language-javascript">let hikes = [
  'Lost Lake',
  'Canyon Creek Meadows',
];

let randomHike = () =&gt;
  hikes[Math.floor(Math.random() * hikes.length)];

let responder = (message) =&gt; {
  if (message === 'list hikes') {
    return hikes.join('\n');
  } else if (message === 'recommend hike') {
    return `I recommend ${randomHike()}`;
  } else if (message.startsWith('add hike')) {
    let hike = message.slice(9);
    hikes.push(hike);
    return `Added ${hike}!`;
  }

  return "Sorry, I don't understand that.";
};
</code></pre>
<p>This code is short right now, but that‚Äôs because our chatbot only supports 3 commands so far. It will need to understand many more commands, and each new command will add another if-else case.</p>
<p>Ballooning if-else or switch statements are a code smell that suggest the responder function might have too many responsibilities.</p>
<p>So how could we eliminate these cascading if-else statements before they grow to hundreds of cases?</p>
<p>Enter the Router. The Router is a design pattern that helps us turn a giant if-else or switch statement inside out by decoupling the responsibility of routing logic from the business logic of the individual cases.</p>
<p>The Router pattern is particularly nice because we can follow a step-by-step procedure to refactor the code, and at each step the code should still run.</p>
<p>The first step is to extract each case into a separate function and list them in a data structure, like a plain ol‚Äô JavaScript object. Let‚Äôs move the code for the 3 chatbot commands into an object called ‚Äúresponses‚Äù, using the command as the key.</p>
<pre><code class="language-javascript">let responses = {
  'list hikes': () =&gt;
    hikes.join('\n'),
  'recommend hike': () =&gt;
    `I recommend ${randomHike()}`,
  'add hike': (message) =&gt; {
    let hike = message.slice(9);
    hikes.push(hike);
    return `Added ${hike}!`;
  },
};
</code></pre>
<p>Now that we‚Äôve moved each command into responses, we can replace the cases by looking up the appropriate response function and invoking it. At this point, our code should still work exactly as before.</p>
<pre><code class="language-javascript">let responder = (message) =&gt; {
  if (message === 'list hikes') {
    return responses['list hikes']();
  } else if (message === 'recommend hike') {
    return responses['recommend hike']();
  } else if (message.startsWith('add hike')) {
    return responses['add hike'](message);
  }

  return "Sorry, I don't understand that.";
};
</code></pre>
<p>We‚Äôve finished the first step ‚Äî it‚Äôs usually pretty mechanical, but it often spawns other refactors as you discover subtle side effects and hidden dependencies that need to be passed as an argument. For example, we quickly realized that the ‚Äúadd hike‚Äù command needs the rest of the chat message so it can extract the name of the hike.</p>
<p>Now for step 2: let‚Äôs collapse the cascading if-else statements. Since each response is listed with its corresponding command in the responses object, we can use the message to directly look up the appropriate response function.</p>
<pre><code class="language-javascript">let responder = (message) =&gt; {
  let response = responses[message];
  if (response) {
    return response(message);
  }

  return "Sorry, I don't understand that.";
};
</code></pre>
<p>If a matching response function is found, we‚Äôll invoke it. Also, since one of our chatbot commands needs the message, we‚Äôll pass it as an argument. You‚Äôll need to find a parameter signature that works for any of your response functions, so this may take some additional refactoring. But it‚Äôs okay if a response function ignores those arguments, as the ‚Äúlist hikes‚Äù and ‚Äúrecommend hike‚Äù commands do.</p>
<p>Nice, we collapsed a 3 case if-else statement into one! In step 3 we‚Äôll eliminate the if-else statement altogether by extracting the fallback behavior into a function of its own. If no response function matched, we‚Äôll use the double pipe operator to insert the fallback response. Now that we know the response variable will always contain a function, we can invoke it unconditionally.</p>
<pre><code class="language-javascript">let fallback = () =&gt;
  "Sorry, I don't understand that.";

let responder = (message) =&gt; {
  let response = responses[message] || fallback;
  return response(message);
};
</code></pre>
<p>And that‚Äôs it! The Router pattern helped us turn an if-else statement with several cases inside out. And now the responder function, which was destined to grow without bound, is a simple shell that just dispatches the message to the appropriate response function. In backend terminology, we call the responder function a ‚Äúrouter,‚Äù and the commands are called ‚Äúroutes.‚Äù</p>
<p>Unfortunately, we broke the ‚Äúadd hike‚Äù command that expects the message to include the name of the hike after the command, so our simple property lookup isn‚Äôt flexible enough.</p>
<p>To fix this, we‚Äôll convert responses to a list and use the <code>find</code> Array method to see which command the message starts with.</p>
<pre><code class="language-javascript">let responder = (message) =&gt; {
  let [command, response] = Object.entries(responses)
    .find(([command, response]) =&gt;
      message.startsWith(command)
    );
  return response(message);
};
</code></pre>
<p>Now that we‚Äôve switched to <code>startsWith</code>, we can move the fallback code to the responses object, and use an empty string as the key! We just need to make sure it comes last. Now we‚Äôve eliminated conditionals from the responder function entirely!</p>
<pre><code class="language-javascript">let responses = {
  'list hikes': ... ,
  'recommend hike': ... ,
  'add hike': ... ,
  '': () =&gt;
    "Sorry, I don't understand that."
};
</code></pre>
<p>See how control flow got replaced by a data structure? That‚Äôs a recurring theme in software design: many problems that are traditionally solved with algorithmic code can be described much more elegantly with a data structure, which is easier to debug, extend and reason about.</p>
<p>In the Router pattern, the mapping data structure doesn‚Äôt even have to be an object. We could turn the responses object into an array of objects, with one object per command!</p>
<pre><code class="language-javascript">let responses = [
  {
    command: 'list hikes',
    response: () =&gt; hikes.join('\n')
  },
  {
    command: 'recommend hike',
    response: () =&gt; `I recommend ${randomHike()}`
  },
  {
    command: 'add hike',
    response: (message) =&gt; {
      let hike = message.slice(9);
      hikes.push(hike);
      return `Added ${hike}!`;
    }
  },
  {
    command: '',
    response: () =&gt;
      "Sorry, I don't understand that."
  }
];
</code></pre>
<p>This format gives us flexibility: to define more complex commands, we can easily switch from strings to regular expressions, and even define capture groups for the response function to receive as an argument!</p>
<pre><code class="language-javascript">let responses = [
  {
    command: /^list hikes$/,
    response: () =&gt; hikes.join('\n')
  },
  {
    command: /^recommend hike$/,
    response: () =&gt; `I recommend ${randomHike()}`
  },
  {
    command: /^add hike (.+)$/,
    response: ([hike]) =&gt; {
      hikes.push(hike);
      return `Added ${hike}!`;
    }
  },
  {
    command: /^(.*)$/,
    response: ([message]) =&gt;
      `Sorry, I don't understand "${message}".`
  }
];

let responder = (message) =&gt; {
  let { command, response } = responses
    .find(({ command, response }) =&gt;
      command.test(message)
    );
  return response(
    command.exec(message).slice(1)
  );
};
</code></pre>
<p>Not only did that simplify the code for ‚Äúadd hike‚Äù, but it provides new team members with a template for adding new commands. It‚Äôs pretty straightforward to add ‚Äúwhere is‚Äù by using ‚Äúadd hike‚Äù as a starting point.</p>
<pre><code class="language-javascript">let responses = [
  ...
  {
    command: /^where is (.+)$/,
    response: ([hike]) =&gt;
      `${hike}? Do I look like a GPS receiver?`
  },
  ...
];
</code></pre>
<p>The Router pattern helps us discover common needs across if-else cases and provide a flexible interface to DRY them up. Because the routing logic is backed by a data structure, we can do things that were previously impossible with hard-wired if-else or switch statements, like dynamically enabling particular commands at runtime.</p>
<p>And with each case extracted into a function, we can unit test each response without going through the routing logic first!</p>
<p>The Router pattern helps solve the same problems in Functional Programming that polymorphism does in Object Oriented Programming. And it pops up everywhere: in React you might use this pattern to select which component to render, on the backend you could decide which handler function to invoke for a webhook, in a Redux reducer you can delegate state updates to smaller reducers, and of course on the backend you can define routes for a particular URL.</p>
<p>Today, scan through your codebase for switch and if-else statements that tend to grow with each feature request, and use the Router pattern to turn it inside out.</p>
<p>That‚Äôs it for today. Want to keep leveling up your craft? Don‚Äôt forget to <a href="https://www.youtube.com/channel/UCol-gOYBawJGqUn2AhwxhNg">subscribe to the channel</a> for more rapid codecasts on design patterns, refactoring and development approaches.</p>


            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="https://jonathanleemartin.com">tl;dr</a> &copy; 2019</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
</html>
